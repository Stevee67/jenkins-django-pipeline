node('docker') {
    stage 'Checkout'
        checkout scm
    stage 'Build & UnitTest'
        sh "ls -l"
        sh "docker build -t admin-panel:B${BUILD_NUMBER} -f admin-panel/Dockerfile ."
        sh "docker-compose -f docker-compose.ci.yaml run --rm admin-panel bash -c 'ls -l && cd admin_panel && py.test -v'"
    stage 'Cleanup'
        sh "docker rmi admin-panel:B${BUILD_NUMBER}"
}